/*
 * Picker Plugin
 * @author Ben Plum
 * @version 0.2.7
 *
 * Copyright Â© 2012 Ben Plum <mr@benplum.com>
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */

if(jQuery)(function(b){function l(a){a=a||{};var e=b.extend({},d,a);return b(this).each(function(){var a=b(this);if(!a.data("picker")){var c=b("label[for="+a.attr("id")+"]"),f=b(b.merge(b.merge([],a),c)),d=a.attr("type"),h="picker-"+("radio"==d?"radio":"checkbox"),g=a.attr("name");f.wrapAll('<div class="picker '+h+" "+e.customClass+'" />');a.addClass("picker-element").after('<div class="picker-handle"><div class="picker-flag" /></div>');c.addClass("picker-label");f=a.parent(".picker");h=f.find(".picker-handle"); a.is(":checked")&&f.addClass("checked");a.is(":disabled")&&f.addClass("disabled");c=b.extend({$picker:f,$input:a,$handle:h,$label:c,group:g,isRadio:"radio"==d,isCheckbox:"checkbox"==d},e);a.on("focus.picker",c,m).on("blur.picker",c,n).on("change.picker",c,p).on("deselect.picker",c,j);f.on("click.picker",".picker-handle",c,q).data("picker",c)}})}function q(a){a.preventDefault();a.stopPropagation();var b=a.data;b.$input.is(":disabled")||(b.$input.is(":checked")?b.isRadio||j(a):g(a))}function p(a){var b= a.data;b.$input.is(":disabled")||(b.$input.is(":checked")?g(a):j(a))}function g(a){a=a.data;"undefined"!==typeof a.group&&a.isRadio&&b('input[name="'+a.group+'"]').not(a.$input).trigger("deselect");a.$input.prop("checked",!0);a.$picker.addClass("checked")}function j(a){a=a.data;a.$input.prop("checked",!1);a.$picker.removeClass("checked")}function m(a){a.data.$picker.addClass("focus")}function n(a){a.data.$picker.removeClass("focus")}var d={customClass:""},k={defaults:function(a){d=b.extend(d,a||{}); return b(this)},disable:function(){return b(this).each(function(){var a=b(this),e=a.parent(".picker");a.prop("disabled",!0);e.addClass("disabled")})},enable:function(){return b(this).each(function(){var a=b(this),e=a.parent(".picker");a.prop("disabled",!1);e.removeClass("disabled")})},destroy:function(){return b(this).each(function(){var a=b(this),e=a.parent(".picker"),d=e.find(".picker-handle"),c=b("label[for="+a.attr("id")+"]");e.off(".picker");d.remove();a.off(".picker").removeClass("picker-element").unwrap(); c.removeClass("picker-label")})}};b.fn.picker=function(a){return k[a]?k[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"===typeof a||!a?l.apply(this,arguments):this}})(jQuery);