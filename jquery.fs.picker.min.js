/*
 * Picker Plugin
 * @author Ben Plum
 * @version 0.3.1
 *
 * Copyright Â© 2013 Ben Plum <mr@benplum.com>
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */
 
if(jQuery)(function(b){function r(a){a=b.extend({},m,a);for(var c=b(this),d=0,s=c.length;d<s;d++){var e=c.eq(d),f=a;if(!e.data("picker")){var f=b.extend({},f,e.data("picker-options")),j=b("label[for="+e.attr("id")+"]"),g=b(e.parents("label")[0]==j[0]?b.merge([],j):b.merge(b.merge([],e),j)),n=e.attr("type"),k="picker-"+("radio"==n?"radio":"checkbox"),h=e.attr("name"),l='<div class="picker-handle"><div class="picker-flag" /></div>';f.toggle&&(k+=" picker-toggle",l='<span class="picker-toggle-label on">'+f.labelOn+ '</span><span class="picker-toggle-label off">'+f.labelOff+"</span>"+l);g.wrapAll('<div class="picker '+k+" "+f.customClass+'" />');e.addClass("picker-element").after(l);j.addClass("picker-label");g=e.parents(".picker");k=g.find(".picker-handle");l=g.find(".picker-toggle-label");e.is(":checked")&&g.addClass("checked");e.is(":disabled")&&g.addClass("disabled");b.extend(f,{$picker:g,$input:e,$handle:k,$label:j,$labels:l,group:h,isRadio:"radio"==n,isCheckbox:"checkbox"==n});e.on("focus.picker",f,t).on("blur.picker", f,u).on("change.picker",f,v).on("deselect.picker",f,p);g.on("click.picker",f,w).data("picker",f)}}return c}function w(a){a.preventDefault();a.stopPropagation();var c=a.data;c.$input.is(":disabled")||(c.$input.is(":checked")?c.isRadio||p(a):h(a))}function v(a,c){if(!c){var b=a.data;b.$input.is(":disabled")||(b.$input.is(":checked")?h(a,!0):p(a,!0))}}function h(a,c){var d=a.data;"undefined"!==typeof d.group&&d.isRadio&&b('input[name="'+d.group+'"]').not(d.$input).trigger("deselect");d.$input.prop("checked", !0);d.$picker.addClass("checked");c||d.$input.trigger("change",[!0])}function p(a,b){var d=a.data;d.$input.prop("checked",!1);d.$picker.removeClass("checked");b||d.$input.trigger("change",[!0])}function t(a){a.data.$picker.addClass("focus")}function u(a){a.data.$picker.removeClass("focus")}var m={customClass:"",toggle:!1,labelOn:"ON",labelOff:"OFF"},q={defaults:function(a){m=b.extend(m,a||{});return b(this)},disable:function(){return b(this).each(function(){var a=b(this),c=a.parent(".picker");a.prop("disabled", !0);c.addClass("disabled")})},enable:function(){return b(this).each(function(){var a=b(this),c=a.parent(".picker");a.prop("disabled",!1);c.removeClass("disabled")})},destroy:function(){return b(this).each(function(){var a=b(this),c=a.parent(".picker"),d=c.find(".picker-handle"),h=c.find(".picker-toggle-label"),e=b("label[for="+a.attr("id")+"]");c.off(".picker");d.remove();h.remove();a.off(".picker").removeClass("picker-element").unwrap();e.removeClass("picker-label")})}};b.fn.picker=function(a){return q[a]? q[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"===typeof a||!a?r.apply(this,arguments):this}})(jQuery);